<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆØ±ÙˆØ²ÛŒ Û±Û´Û°Ûµ</title>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; font-family: 'Vazirmatn', sans-serif; }
        body { 
            margin: 0; padding: 10px; direction: rtl; min-height: 100vh;
            background: #f4f7f6; display: flex; justify-content: center; align-items: flex-start;
        }

        .container {
            width: 100%; max-width: 900px; background: #fff;
            display: flex; flex-direction: row; /* Ø­Ø§Ù„Øª Ø¯Ø³Ú©ØªØ§Ù¾ */
            border-radius: 20px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .form-side { flex: 1; padding: 30px; background: #2c3e50; color: white; }
        .table-side { flex: 1.5; padding: 20px; background: #fff; overflow-x: auto; }

        h1 { font-size: 1.5rem; text-align: center; margin-bottom: 25px; }
        input, select, button { 
            width: 100%; height: 50px; margin-bottom: 15px; 
            border-radius: 12px; border: 1px solid #ddd; padding: 0 15px; font-size: 16px;
        }

        button { 
            background: #f1c40f; border: none; font-weight: bold; cursor: pointer;
            transition: 0.2s; color: #2c3e50;
        }
        button:active { transform: scale(0.98); }

        table { width: 100%; border-collapse: collapse; min-width: 350px; }
        th { background: #16a085; color: white; padding: 12px; font-size: 14px; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-size: 14px; }

        .btn-delete { background: #e74c3c; color: white; padding: 5px 12px; border-radius: 8px; font-size: 12px; }

        /* Ù…ÙˆØ¨Ø§ÛŒÙ„ (ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ Ú©ÙˆÚ†Ú©) */
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .form-side { padding: 20px; }
            .table-side { padding: 10px; }
            h1 { font-size: 1.2rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="form-side">
        <h1>ğŸ“… Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†ÙˆØ±ÙˆØ²</h1>
        <select id="type">
            <option value="Ø±ÙˆØ²">â˜€ï¸ Ù†Ø§Ù‡Ø§Ø± (Ø±ÙˆØ²)</option>
            <option value="Ø´Ø¨">ğŸŒ™ Ø´Ø§Ù… (Ø´Ø¨)</option>
        </select>
        <input type="number" id="dayNumber" placeholder="Ø¹Ø¯Ø¯ Ø±ÙˆØ² (Û± ØªØ§ Û±Ûµ)" min="1" max="15">
        <input type="text" id="relative" placeholder="Ù†Ø§Ù… Ù…Ù‡Ù…Ø§Ù† / Ù†Ø³Ø¨Øª ÙØ§Ù…ÛŒÙ„ÛŒ">
        <button onclick="addData()">Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ù„ÛŒØ³Øª</button>
    </div>

    <div class="table-side">
        <table>
            <thead>
                <tr>
                    <th>Ø²Ù…Ø§Ù†</th>
                    <th>ØªØ§Ø±ÛŒØ®</th>
                    <th>Ù…Ù‡Ù…Ø§Ù†</th>
                    <th>Ø­Ø°Ù</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
    const API_URL = 'https://noruz.pxxl.click/api/entries';

    async function loadData() {
        try {
            const res = await fetch(API_URL);
            const data = await res.json();
            const table = document.getElementById("tableBody");
            table.innerHTML = data.map(item => `
                <tr>
                    <td>${item.type}</td>
                    <td>01/${String(item.dayNumber).padStart(2, '0')}</td>
                    <td>${item.relative}</td>
                    <td><button class="btn-delete" onclick="deleteRow('${item.type}',${item.dayNumber})">Ø­Ø°Ù</button></td>
                </tr>
            `).join('');
        } catch (e) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù„ÛŒØ³Øª"); }
    }

    async function addData() {
        const type = document.getElementById("type").value;
        const dayNumber = document.getElementById("dayNumber").value;
        const relative = document.getElementById("relative").value;

        if(!dayNumber || !relative) return alert("Ù„Ø·ÙØ§ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯");

        const res = await fetch(API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ type, dayNumber, relative })
        });

        if (res.ok) {
            document.getElementById("relative").value = "";
            loadData();
        } else {
            const err = await res.json();
            alert(err.error);
        }
    }

    async function deleteRow(type, dayNumber) {
        if(!confirm("Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ")) return;
        await fetch(API_URL, {
            method: 'DELETE',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ type, dayNumber })
        });
        loadData();
    }

    window.onload = loadData;
</script>

</body>
</html>